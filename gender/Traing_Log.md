# Traing process and result

Data: 
PA100K + RAP(part)

Data Structure:
![File_structure](./Images/File_structure.PNG)
![File_structure](./Images/File_structure2.PNG)

1.Fsirt time

3 Convolution Layer 

Network structure is like :

Layer (type)                 Output Shape              Param  
=================================================================
conv2d_1 (Conv2D)            (None, 98, 248, 32)       896       
_________________________________________________________________
activation_1 (Activation)    (None, 98, 248, 32)       0         
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 49, 124, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 47, 122, 32)       9248      
_________________________________________________________________
activation_2 (Activation)    (None, 47, 122, 32)       0         
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 23, 61, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 21, 59, 64)        18496     
_________________________________________________________________
activation_3 (Activation)    (None, 21, 59, 64)        0         
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 10, 29, 64)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 18560)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 64)                1187904   
_________________________________________________________________
activation_4 (Activation)    (None, 64)                0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 65        
_________________________________________________________________
activation_5 (Activation)    (None, 1)                 0         
=================================================================

Total params: 1,216,609
Trainable params: 1,216,609
Non-trainable params: 0
_________________________________________________________________

Training result:

![](./Images/accuracy_1st.png)

2.second time

Conv block 1 (frozen)==> conv block 2 (frozen)==> conv block 3 (frozen)==>conv block 4 (frozen)==> conv block 5 (fine tune)==> our own Fully connected classifer(fine tune)

Network structure is like :

Layer (type)                 Output Shape              Param  
=================================================================
zero_padding2d_1 (ZeroPaddin (None, 102, 252, 3)       0         
_________________________________________________________________
conv1_1 (Conv2D)             (None, 100, 250, 64)      1792      
_________________________________________________________________
zero_padding2d_2 (ZeroPaddin (None, 102, 252, 64)      0         
_________________________________________________________________
conv1_2 (Conv2D)             (None, 100, 250, 64)      36928     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 50, 125, 64)       0         
_________________________________________________________________
zero_padding2d_3 (ZeroPaddin (None, 52, 127, 64)       0         
_________________________________________________________________
conv2_1 (Conv2D)             (None, 50, 125, 128)      73856     
_________________________________________________________________
zero_padding2d_4 (ZeroPaddin (None, 52, 127, 128)      0         
_________________________________________________________________
conv2_2 (Conv2D)             (None, 50, 125, 128)      147584    
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 25, 62, 128)       0         
_________________________________________________________________
zero_padding2d_5 (ZeroPaddin (None, 27, 64, 128)       0         
_________________________________________________________________
conv3_1 (Conv2D)             (None, 25, 62, 256)       295168    
_________________________________________________________________
zero_padding2d_6 (ZeroPaddin (None, 27, 64, 256)       0         
_________________________________________________________________
conv3_2 (Conv2D)             (None, 25, 62, 256)       590080    
_________________________________________________________________
zero_padding2d_7 (ZeroPaddin (None, 27, 64, 256)       0         
_________________________________________________________________
conv3_3 (Conv2D)             (None, 25, 62, 256)       590080    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 31, 256)       0         
_________________________________________________________________
zero_padding2d_8 (ZeroPaddin (None, 14, 33, 256)       0         
_________________________________________________________________
conv4_1 (Conv2D)             (None, 12, 31, 512)       1180160   
_________________________________________________________________
zero_padding2d_9 (ZeroPaddin (None, 14, 33, 512)       0         
_________________________________________________________________
conv4_2 (Conv2D)             (None, 12, 31, 512)       2359808   
_________________________________________________________________
zero_padding2d_10 (ZeroPaddi (None, 14, 33, 512)       0         
_________________________________________________________________
conv4_3 (Conv2D)             (None, 12, 31, 512)       2359808   
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 15, 512)        0         
_________________________________________________________________
zero_padding2d_11 (ZeroPaddi (None, 8, 17, 512)        0         
_________________________________________________________________
conv5_1 (Conv2D)             (None, 6, 15, 512)        2359808   
_________________________________________________________________
zero_padding2d_12 (ZeroPaddi (None, 8, 17, 512)        0         
_________________________________________________________________
conv5_2 (Conv2D)             (None, 6, 15, 512)        2359808   
_________________________________________________________________
zero_padding2d_13 (ZeroPaddi (None, 8, 17, 512)        0         
_________________________________________________________________
conv5_3 (Conv2D)             (None, 6, 15, 512)        2359808   
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 3, 7, 512)         0         
_________________________________________________________________
sequential_2 (Sequential)    (None, 1)                 2753025   
=================================================================
Total params: 17,467,713
Trainable params: 16,322,305
Non-trainable params: 1,145,408
_________________________________________________________________

Traing result:

![](./Images/accuracy_2nd.png)

Test result:

Based on PA100K dataset: 10000

female==>female  0.796
female==>male    0.203

male==>male      0.472
male==>female    0.527


Based on Airport dataset: 200

female==>female  0.76
female==>male    0.24

male==>male      0.49
male==>female    0.51


